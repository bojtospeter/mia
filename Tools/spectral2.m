function s = spectral(m)
%SPECTRAL Black-purple-blue-green-yellow-red-white color map.
%
%         map = spectral(num_colors)
%
% SPECTRAL(M) returns an M-by-3 matrix containing a "spectral" colormap.
% SPECTRAL, by itself, is the same length as the current colormap.
%
% For example, to reset the colormap of the current figure:
%
%           colormap(spectral)
%
% See also HSV, GRAY, PINK, HOT, COOL, BONE, COPPER, FLAG,
%          COLORMAP, RGBPLOT.

% $Id: spectral.m,v 1.4 1997/10/20 18:23:22 greg Rel $
% $Name: emma_v0_9_5 $

%         Copyright (c) 1984-92 by The MathWorks, Inc.
%         Spectral version made by Gabriel Leger, MBIC, MNI (c) 1993

if nargin < 1, m = size(get(gcf,'colormap'),1); end

n = fix(3/8*m);

base = [
 1	0	0	0
2	0	0	0
3	0	0	0
4	0	0	0
5	0.04	0	0.0686
6	0.1084	0	0.1858
7	0.1767	0	0.3029
8	0.235	0	0.4067
9	0.2448	0	0.4457
10	0.2545	0	0.4848
11	0.2643	0	0.5238
12	0.2667	0	0.5481
13	0.2667	0	0.5676
14	0.2667	0	0.5872
15	0.2667	0	0.61
16	0.2667	0	0.6393
17	0.2667	0	0.6686
18	0.2667	0	0.6979
19	0.2667	0	0.7227
20	0.2667	0	0.7471
21	0.2667	0	0.7715
22	0.2667	0	0.7934
23	0.2667	0	0.8129
24	0.2667	0	0.8324
25	0.2662	0	0.8529
26	0.2613	0	0.8822
27	0.2564	0	0.9115
28	0.2515	0	0.9408
29	0.2333	0.0067	0.96
30	0.2089	0.0165	0.9747
31	0.1844	0.0262	0.9893
32	0.1614	0.0439	1
33	0.1418	0.083	1
34	0.1223	0.122	1
35	0.1028	0.1611	1
36	0.0749	0.2085	1
37	0.0456	0.2573	1
38	0.0163	0.3061	1
39	0	0.3506	1
40	0	0.3897	1
41	0	0.4287	1
42	0	0.4675	1
43	0	0.4968	1
44	0	0.5261	1
45	0	0.5554	1
46	0	0.5907	1
47	0	0.6297	1
48	0	0.6688	1
49	0	0.7049	1
50	0	0.7293	1
51	0	0.7537	1
52	0	0.7781	1
53	0	0.7948	1
54	0	0.8095	1
55	0	0.8241	1
56	0	0.8406	1
57	0	0.8601	1
58	0	0.8796	1
59	0	0.8992	1
60	0	0.914	1
61	0	0.9287	1
62	0	0.9433	1
63	0.0026	0.9579	1
64	0.0075	0.9726	1
65	0.0124	0.9872	1
66	0.0198	1	0.9994
67	0.0442	1	0.9945
68	0.0686	1	0.9896
69	0.093	1	0.9847
70	0.1209	1	0.9798
71	0.1502	1	0.975
72	0.1795	1	0.9701
73	0.2117	1	0.9637
74	0.2508	1	0.954
75	0.2898	1	0.9442
76	0.3289	1	0.9344
77	0.3333	1	0.8987
78	0.3333	1	0.8597
79	0.3333	1	0.8206
80	0.3333	1	0.7885
81	0.3333	1	0.7641
82	0.3333	1	0.7397
83	0.3333	1	0.7147
84	0.3333	1	0.6805
85	0.3333	1	0.6464
86	0.3333	1	0.6122
87	0.3333	1	0.578
88	0.3333	1	0.5439
89	0.3333	1	0.5097
90	0.3333	1	0.4766
91	0.3333	1	0.4474
92	0.3333	1	0.4181
93	0.3333	1	0.3888
94	0.3373	1	0.3515
95	0.3422	1	0.3125
96	0.3471	1	0.2734
97	0.3539	1	0.2305
98	0.3637	1	0.1817
99	0.3734	1	0.1328
100	0.3832	1	0.084
101	0.393	1	0.0593
102	0.4027	1	0.0349
103	0.4125	1	0.0105
104	0.4306	1	0
105	0.455	1	0
106	0.4794	1	0
107	0.5031	1	0
108	0.5226	1	0
109	0.5421	1	0
110	0.5616	1	0
111	0.5848	1	0
112	0.6092	1	0
113	0.6336	1	0
114	0.658	1	0
115	0.6824	1	0
116	0.7068	1	0
117	0.7312	1	0
118	0.7512	1	0
119	0.7707	1	0
120	0.7902	1	0
121	0.8122	1	0
122	0.8366	1	0
123	0.861	1	0
124	0.8854	1	0
125	0.9098	1	0
126	0.9342	1	0
127	0.9586	1	0
128	0.9732	1	0
129	0.983	1	0
130	0.9927	1	0
131	1	1	0.0075
132	1	1	0.0368
133	1	1	0.0661
134	1	1	0.0954
135	1	1	0.1165
136	1	1	0.136
137	1	1	0.1555
138	1	1	0.1729
139	1	1	0.1876
140	1	1	0.2022
141	1	0.9999	0.2169
142	1	0.995	0.2315
143	1	0.9902	0.2462
144	1	0.9853	0.2608
145	1	0.9775	0.2637
146	1	0.9677	0.2589
147	1	0.9579	0.254
148	1	0.9482	0.2482
149	1	0.9384	0.2384
150	1	0.9287	0.2287
151	1	0.9189	0.2189
152	1	0.9054	0.2091
153	1	0.8907	0.1994
154	1	0.8761	0.1896
155	1	0.8632	0.1798
156	1	0.8534	0.1701
157	1	0.8437	0.1603
158	1	0.8339	0.1506
159	1	0.8241	0.1408
160	1	0.8144	0.131
161	1	0.8046	0.1213
162	1	0.7923	0.1115
163	1	0.7776	0.1017
164	1	0.763	0.092
165	1	0.7489	0.0822
166	1	0.7391	0.0725
167	1	0.7294	0.0627
168	1	0.7196	0.0529
169	1	0.7098	0.0432
170	1	0.7001	0.0334
171	1	0.6903	0.0236
172	1	0.6791	0.0153
173	1	0.6645	0.0104
174	1	0.6499	0.0055
175	1	0.6352	0.0006
176	1	0.6206	0
177	1	0.6059	0
178	1	0.5913	0
179	1	0.5744	0
180	1	0.5549	0
181	1	0.5354	0
182	1	0.5158	0
183	1	0.4963	0
184	1	0.4768	0
185	1	0.4573	0
186	1	0.4408	0
187	1	0.4262	0
188	1	0.4115	0
189	1	0.3958	0
190	1	0.3763	0
191	1	0.3568	0
192	1	0.3372	0
193	1	0.3177	0
194	1	0.2982	0
195	1	0.2787	0
196	1	0.261	0
197	1	0.2464	0
198	1	0.2317	0
199	1	0.2171	0
200	1	0.1977	0
201	1	0.1782	0
202	1	0.1586	0
203	1	0.1418	0.019
204	1	0.1272	0.0532
205	1	0.1126	0.0874
206	1	0.0972	0.1264
207	1	0.0777	0.1948
208	1	0.0582	0.2631
209	1	0.0386	0.3315
210	1	0.0262	0.3856
211	1	0.0165	0.4344
212	1	0.0067	0.4832
213	1	0	0.5228
214	1	0	0.5423
215	1	0	0.5619
216	1	0	0.5814
217	1	0.0088	0.6053
218	1	0.0185	0.6297
219	1	0.0283	0.6541
220	1	0.0523	0.6738
221	1	0.0914	0.6884
222	1	0.1304	0.7031
223	1	0.1688	0.7174
224	1	0.198	0.7271
225	1	0.2273	0.7369
226	1	0.2566	0.7467
227	1	0.2923	0.7596
228	1	0.3314	0.7743
229	1	0.3704	0.7889
230	1	0.4095	0.8024
231	1	0.4485	0.8121
232	1	0.4876	0.8219
233	1	0.5266	0.8317
234	1	0.5576	0.8414
235	1	0.5869	0.8512
236	1	0.6162	0.8609
237	1	0.6495	0.8727
238	1	0.6886	0.8874
239	1	0.7276	0.902
240	1	0.7667	0.9167
];

n = length(base);

X0 = linspace (1, n, m);

s = table(base,X0)';
